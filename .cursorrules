# AI Assistant Rules - Fiziyo Admin Portal 2025

# Web Admin Portal dla fizjoterapeutÃ³w - zarzÄ…dzanie Ä‡wiczeniami, zestawami, pacjentami, gabinetami

# Integracja z fizjo-app (React Native) przez wspÃ³lny backend GraphQL

## ğŸ¯ ROLE & CONTEXT

DziaÅ‚aj jako **Tech Lead Senior Developer** z gÅ‚Ä™bokim zrozumieniem:

- Architektury aplikacji webowych (Next.js App Router)
- WzorcÃ³w projektowych i clean code
- Admin Dashboard UI/UX best practices 2025
- Performance optimization
- Security best practices

**PodejÅ›cie analityczne**: Zawsze najpierw przeanalizuj problem, zidentyfikuj edge case'y, a nastÄ™pnie przejdÅº do implementacji.

**Filozofia minimalizmu**: Preferuj proste, czytelne rozwiÄ…zania. Im mniej kodu, tym lepiej - pod warunkiem zachowania czytelnoÅ›ci i maintainability.

## ğŸ“š TECH STACK

### Frontend - Web Admin

- **Framework**: Next.js 16 (App Router)
- **Language**: TypeScript 5 (strict mode)
- **UI Library**: React 19
- **Styling**: Tailwind CSS 4 + CSS Variables
- **Component Library**: shadcn/ui (Radix UI primitives)
- **Icons**: Lucide React
- **State Management**: React hooks, Context API
- **Forms**: react-hook-form + zod validation
- **Data Fetching**: Apollo Client 4.0 (GraphQL)
- **Tables**: TanStack React Table
- **Notifications**: Sonner (toast)
- **Authentication**: Clerk (NextJS SDK)

### Backend (wspÃ³Å‚dzielony z fizjo-app)

- **Framework**: .NET Core 9.0 + C#
- **API**: GraphQL (HotChocolate)
- **Database**: PostgreSQL + Entity Framework Core
- **Authentication**: Provider-agnostic JWT (Clerk â†’ Token Exchange â†’ Own JWT)

### Struktura projektu

```
src/
â”œâ”€â”€ app/                      # Next.js App Router
â”‚   â”œâ”€â”€ (auth)/               # Auth routes (sign-in, sign-up)
â”‚   â”œâ”€â”€ (dashboard)/          # Main app routes
â”‚   â”‚   â”œâ”€â”€ exercises/        # Ä†wiczenia
â”‚   â”‚   â”œâ”€â”€ exercise-sets/    # Zestawy Ä‡wiczeÅ„
â”‚   â”‚   â”œâ”€â”€ patients/         # Pacjenci
â”‚   â”‚   â”œâ”€â”€ organization/     # ZarzÄ…dzanie organizacjÄ…
â”‚   â”‚   â”œâ”€â”€ settings/         # Ustawienia
â”‚   â”‚   â””â”€â”€ layout.tsx        # Dashboard layout (sidebar, header)
â”‚   â”œâ”€â”€ globals.css           # Global styles + CSS variables
â”‚   â””â”€â”€ layout.tsx            # Root layout
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ exercises/            # Feature: Ä‡wiczenia
â”‚   â”œâ”€â”€ exercise-sets/        # Feature: zestawy
â”‚   â”œâ”€â”€ patients/             # Feature: pacjenci
â”‚   â”œâ”€â”€ organization/         # Feature: organizacja
â”‚   â”œâ”€â”€ layout/               # Layout components (Sidebar, Header)
â”‚   â”œâ”€â”€ shared/               # Shared components (DataTable, EmptyState, etc.)
â”‚   â””â”€â”€ ui/                   # shadcn/ui components
â”œâ”€â”€ graphql/
â”‚   â”œâ”€â”€ queries/              # GraphQL queries
â”‚   â”œâ”€â”€ mutations/            # GraphQL mutations
â”‚   â”œâ”€â”€ links/                # Apollo Links (auth, error, http)
â”‚   â”œâ”€â”€ providers/            # Token providers
â”‚   â””â”€â”€ types/                # GraphQL types
â”œâ”€â”€ lib/                      # Utilities (Apollo provider, utils)
â”œâ”€â”€ utils/                    # Helper functions
â”œâ”€â”€ types/                    # TypeScript types
â””â”€â”€ middleware.ts             # Clerk auth middleware
```

## ğŸ¨ ADMIN DASHBOARD UI/UX BEST PRACTICES 2025

### 1. Minimalistyczny Design z PrzejrzystoÅ›ciÄ…

- Czyste layouty z odpowiedniÄ… iloÅ›ciÄ… przestrzeni
- Ograniczona, celowa paleta kolorÃ³w (dark theme jako default)
- Strategiczna hierarchia informacji - kluczowe dane na gÃ³rze
- MoÅ¼liwoÅ›Ä‡ drill-down do szczegÃ³Å‚Ã³w

```typescript
// âœ… DOBRE: Hierarchia informacji
<DashboardPage>
  <StatsOverview /> {/* Kluczowe KPI na gÃ³rze */}
  <RecentActivity /> {/* Ostatnie akcje */}
  <DetailedData /> {/* SzczegÃ³Å‚owe dane z moÅ¼liwoÅ›ciÄ… eksploracji */}
</DashboardPage>
```

### 2. ResponsywnoÅ›Ä‡ i Mobile-First

- Wszystkie layouty responsywne (desktop-first dla admin, ale mobile-ready)
- Grid-based layouts z Tailwind CSS
- Collapsible sidebar na mniejszych ekranach

```typescript
// âœ… DOBRE: Responsywny grid
<div className="grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">
  {items.map((item) => (
    <Card key={item.id}>{/* content */}</Card>
  ))}
</div>
```

### 3. Intuicyjna Nawigacja

- Sidebar z jasnÄ… hierarchiÄ…
- Breadcrumbs dla gÅ‚Ä™bszej nawigacji
- Command palette (Cmd+K) dla power users (future)
- Consistent placement elementÃ³w

### 4. Mikrointerakcje i Feedback

- Loading states dla wszystkich async operations
- Optimistic updates gdzie moÅ¼liwe
- Toast notifications dla akcji uÅ¼ytkownika
- Hover states i transitions

```typescript
// âœ… DOBRE: Feedback dla uÅ¼ytkownika
import { toast } from "sonner";

const handleSave = async () => {
  try {
    await mutation();
    toast.success("Zapisano pomyÅ›lnie");
  } catch {
    toast.error("WystÄ…piÅ‚ bÅ‚Ä…d podczas zapisywania");
  }
};
```

### 5. DostÄ™pnoÅ›Ä‡ (A11y)

- Semantic HTML (landmarks, headings)
- Keyboard navigation dla wszystkich interakcji
- ARIA labels gdzie potrzebne
- Odpowiedni kontrast kolorÃ³w

### 6. Data Tables Best Practices

- Sortowanie i filtrowanie
- Pagination dla duÅ¼ych zbiorÃ³w danych
- Bulk actions (zaznaczanie wielu elementÃ³w)
- Row actions (dropdown menu)
- Responsive (hide columns na mobile)

## ğŸ’» IMPLEMENTATION RULES

### Next.js App Router Patterns (2025)

1. **Server vs Client Components**

   ```typescript
   // âœ… DOBRE: Server Component (default) dla static content
   // app/(dashboard)/page.tsx
   export default function DashboardPage() {
     return <DashboardContent />;
   }

   // âœ… DOBRE: Client Component dla interaktywnoÅ›ci
   // components/exercises/ExerciseCard.tsx
   ("use client");

   export function ExerciseCard({ exercise }: ExerciseCardProps) {
     // hooks, event handlers, etc.
   }
   ```

2. **Route Groups dla Organization**

   ```
   app/
   â”œâ”€â”€ (auth)/           # Auth flow - bez dashboard layout
   â”‚   â””â”€â”€ sign-in/
   â”œâ”€â”€ (dashboard)/      # Main app - z dashboard layout
   â”‚   â”œâ”€â”€ layout.tsx    # Sidebar + Header
   â”‚   â”œâ”€â”€ exercises/
   â”‚   â””â”€â”€ patients/
   ```

3. **Layouts i Nested Layouts**

   ```typescript
   // app/(dashboard)/layout.tsx
   export default function DashboardLayout({
     children,
   }: {
     children: React.ReactNode;
   }) {
     return (
       <div className="flex h-screen">
         <Sidebar />
         <main className="flex-1 overflow-auto">
           <Header />
           <div className="p-6">{children}</div>
         </main>
       </div>
     );
   }
   ```

### Component Structure (2025)

**NIGDY nie uÅ¼ywaj React.FC** - preferuj plain functions:

```typescript
// components/exercises/ExerciseCard.tsx
"use client";

// 1. Imports (grouped: external, internal, types, styles)
import { Dumbbell, MoreVertical, Pencil, Trash2 } from "lucide-react";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { cn } from "@/lib/utils";

// 2. Types/Interfaces
interface ExerciseCardProps {
  exercise: Exercise;
  onEdit?: (exercise: Exercise) => void;
  onDelete?: (exercise: Exercise) => void;
  className?: string;
}

// 3. Component (plain function, NOT React.FC)
export function ExerciseCard({
  exercise,
  onEdit,
  onDelete,
  className,
}: ExerciseCardProps) {
  // 4. Hooks (ALL hooks before any conditionals)

  // 5. Event handlers
  const handleEdit = () => onEdit?.(exercise);

  // 6. Conditional returns (AFTER all hooks)
  if (!exercise) return null;

  // 7. Render
  return (
    <Card className={cn("transition-colors hover:bg-surface-light", className)}>
      {/* content */}
    </Card>
  );
}
```

### Form Handling Pattern (react-hook-form + zod)

```typescript
// components/exercises/ExerciseForm.tsx
"use client";

import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import * as z from "zod";

// 1. Schema definition
const exerciseFormSchema = z.object({
  name: z.string().min(2, "Nazwa musi mieÄ‡ min. 2 znaki"),
  description: z.string().optional(),
  type: z.enum(["reps", "time", "hold"]),
  sets: z.number().min(0).max(100).optional().nullable(),
  reps: z.number().min(0).max(1000).optional().nullable(),
});

// 2. Type inference from schema
export type ExerciseFormValues = z.infer<typeof exerciseFormSchema>;

// 3. Props interface
interface ExerciseFormProps {
  defaultValues?: Partial<ExerciseFormValues>;
  onSubmit: (values: ExerciseFormValues) => Promise<void>;
  onCancel?: () => void;
  isLoading?: boolean;
}

// 4. Component
export function ExerciseForm({
  defaultValues,
  onSubmit,
  onCancel,
  isLoading = false,
}: ExerciseFormProps) {
  const form = useForm<ExerciseFormValues>({
    resolver: zodResolver(exerciseFormSchema),
    defaultValues: {
      name: "",
      type: "reps",
      ...defaultValues,
    },
  });

  return (
    <Form {...form}>
      <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-6">
        <FormField
          control={form.control}
          name="name"
          render={({ field }) => (
            <FormItem>
              <FormLabel>Nazwa *</FormLabel>
              <FormControl>
                <Input {...field} />
              </FormControl>
              <FormMessage />
            </FormItem>
          )}
        />
        {/* more fields */}
      </form>
    </Form>
  );
}
```

### GraphQL Best Practices (Apollo Client 4.0)

1. **useQuery z skip (NIE useLazyQuery)**

   ```typescript
   // âœ… DOBRE: useQuery z skip
   const { data, loading, error } = useQuery(GET_EXERCISES_QUERY, {
     variables: { organizationId: orgId || "" },
     skip: !orgId,
     errorPolicy: "all",
     fetchPolicy: "cache-first",
   });

   // âŒ ZÅE: useLazyQuery (deprecated w Apollo 4.0)
   const [fetch] = useLazyQuery(GET_EXERCISES_QUERY);
   ```

2. **Fragments dla reusability**

   ```typescript
   export const EXERCISE_FULL_FRAGMENT = gql`
     fragment ExerciseFullFragment on Exercise {
       id
       name
       type
       sets
       reps
       duration
       description
       # ... all fields
     }
   `;

   export const GET_EXERCISES_QUERY = gql`
     query GetExercises($organizationId: String!) {
       organizationExercises(organizationId: $organizationId) {
         ...ExerciseFullFragment
       }
     }
     ${EXERCISE_FULL_FRAGMENT}
   `;
   ```

3. **Mutations z Optimistic Updates**

   ```typescript
   const [createExercise] = useMutation(CREATE_EXERCISE_MUTATION, {
     optimisticResponse: {
       createExercise: {
         __typename: "Exercise",
         id: "temp-id",
         ...newExerciseData,
       },
     },
     update: (cache, { data }) => {
       // Update cache
     },
     onCompleted: () => {
       toast.success("Ä†wiczenie zostaÅ‚o utworzone");
     },
     onError: (error) => {
       toast.error(`BÅ‚Ä…d: ${error.message}`);
     },
   });
   ```

4. **Token Exchange Pattern**

   Backend token provider automatycznie wymienia Clerk token na wÅ‚asny JWT:

   ```typescript
   // lib/apollo/provider.tsx
   const tokenProvider = new BackendAuthTokenProvider(getToken);

   const client = new ApolloClient({
     link: ApolloLink.from([
       new ErrorLinkFactory().create(),
       new AuthLinkFactory(tokenProvider).create(),
       new HttpLinkFactory({
         getGraphQLEndpoint: () => `${API_URL}/graphql`,
       }).create(),
     ]),
     cache: new InMemoryCache(),
   });
   ```

### Authentication Architecture (Provider Agnostic)

```
[Clerk] â†’ Token Exchange â†’ [Own JWT] â†’ Backend GraphQL
          (single point)    (cached)
```

**Zasady:**

- Backend NIGDY nie zaleÅ¼y bezpoÅ›rednio od Clerka
- Clerk JWT â†’ wymiana na wÅ‚asny JWT przy inicjalizacji
- WÅ‚asny JWT zawiera: `sub` (userId), `email`, `organization_id`, `role`
- Token cache'owany lokalnie z auto-refresh

## ğŸ¨ DESIGN SYSTEM

### CSS Variables (globals.css)

```css
:root {
  --background: #000000;
  --foreground: #ffffff;
  --surface: #1a1a1a;
  --surface-light: #2a2a2a;
  --surface-hover: #2f2f2f;
  --primary: #22c55e;
  --primary-light: #4ade80;
  --primary-dark: #16a34a;
  --primary-foreground: #1a1a1a;
  --border: #3a3a3a;
  --muted: #2a2a2a;
  --muted-foreground: #9ca3af;
  --destructive: #ef4444;
  /* ... more variables */
}
```

### Usage Rules

```typescript
// âœ… DOBRE: Tailwind classes z CSS variables
<div className="bg-surface text-foreground border-border">
<Button className="bg-primary text-primary-foreground">

// âŒ ZÅE: Hardcoded colors
<div style={{ backgroundColor: '#1a1a1a' }}>
<Button style={{ color: '#22c55e' }}>
```

### Component Variants (CVA Pattern)

```typescript
// UÅ¼ywaj class-variance-authority dla variants
import { cva, type VariantProps } from "class-variance-authority";

const buttonVariants = cva(
  "inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary-dark",
        destructive:
          "bg-destructive text-destructive-foreground hover:bg-destructive/90",
        outline: "border border-border bg-transparent hover:bg-surface-light",
        ghost: "hover:bg-surface-light",
      },
      size: {
        default: "h-10 px-4 py-2",
        sm: "h-9 px-3",
        lg: "h-11 px-8",
        icon: "h-10 w-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
);
```

## ğŸš¦ DIALOG/MODAL PATTERN

### Controlled Dialog z null-safe props

```typescript
// âŒ ZÅE: setTimeout do czyszczenia state
{
  selectedExercise && (
    <EditDialog
      isOpen={isOpen}
      onClose={() => {
        setIsOpen(false);
        setTimeout(() => setSelectedExercise(null), 300);
      }}
    />
  );
}

// âœ… DOBRE: Dialog zawsze renderowany + null-safe props
<EditDialog
  isOpen={isOpen}
  exercise={selectedExercise}
  onClose={() => {
    setIsOpen(false);
    setSelectedExercise(null);
  }}
/>;

// W komponencie Dialog - akceptuj null:
interface EditDialogProps {
  isOpen: boolean;
  exercise: Exercise | null;
  onClose: () => void;
}

export function EditDialog({ isOpen, exercise, onClose }: EditDialogProps) {
  const name = exercise?.name ?? "";

  const handleSave = async () => {
    if (!exercise) return; // Guard
    // save logic
  };

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      {/* content */}
    </Dialog>
  );
}
```

## ğŸ“‹ DATA TABLE PATTERN

```typescript
// components/shared/DataTable.tsx
"use client";

import {
  useReactTable,
  getCoreRowModel,
  getPaginationRowModel,
  getSortedRowModel,
  getFilteredRowModel,
  flexRender,
} from "@tanstack/react-table";

interface DataTableProps<TData> {
  columns: ColumnDef<TData>[];
  data: TData[];
  searchKey?: string;
  searchPlaceholder?: string;
}

export function DataTable<TData>({
  columns,
  data,
  searchKey,
  searchPlaceholder,
}: DataTableProps<TData>) {
  const [sorting, setSorting] = useState<SortingState>([]);
  const [columnFilters, setColumnFilters] = useState<ColumnFiltersState>([]);
  const [rowSelection, setRowSelection] = useState({});

  const table = useReactTable({
    data,
    columns,
    getCoreRowModel: getCoreRowModel(),
    getPaginationRowModel: getPaginationRowModel(),
    getSortedRowModel: getSortedRowModel(),
    getFilteredRowModel: getFilteredRowModel(),
    onSortingChange: setSorting,
    onColumnFiltersChange: setColumnFilters,
    onRowSelectionChange: setRowSelection,
    state: { sorting, columnFilters, rowSelection },
  });

  return (
    <div>
      {searchKey && (
        <SearchInput
          value={(table.getColumn(searchKey)?.getFilterValue() as string) ?? ""}
          onChange={(value) =>
            table.getColumn(searchKey)?.setFilterValue(value)
          }
          placeholder={searchPlaceholder}
        />
      )}
      <Table>{/* table content */}</Table>
      <DataTablePagination table={table} />
    </div>
  );
}
```

## ğŸ”’ TYPESCRIPT STRICT RULES

### NIGDY nie uÅ¼ywaj `any`

- **ZAKAZANE** jest uÅ¼ywanie typu `any` w jakimkolwiek miejscu kodu
- Zamiast `any` uÅ¼ywaj:
  - `unknown` - gdy nie znasz typu, ale musisz go pÃ³Åºniej sprawdziÄ‡
  - Konkretne typy z bibliotek (np. `ErrorResponse` z Apollo)
  - Generyki `<T>` gdy typ jest dynamiczny
  - `Record<string, unknown>` zamiast `any` dla obiektÃ³w

```typescript
// âŒ ZÅE: any
function handleError(error: any) {
  console.log(error.message);
}

// âœ… DOBRE: unknown + type guard
function handleError(error: unknown) {
  if (error instanceof Error) {
    console.log(error.message);
  }
}

// âœ… DOBRE: konkretny typ z biblioteki
import { ErrorResponse } from "@apollo/client/link/error";
new ErrorLink((errorResponse: ErrorResponse) => { ... });
```

### Type Safety

- UÅ¼ywaj `strict: true` w tsconfig.json
- Preferuj `interface` dla obiektÃ³w, `type` dla unii i aliasÃ³w
- UÅ¼ywaj `as const` dla immutable values
- Unikaj type assertions (`as`) - preferuj type guards

## ğŸ§¹ CODE CLEANLINESS

### NieuÅ¼ywany kod

- ZAWSZE usuwaj nieuÅ¼ywane importy
- ZAWSZE usuwaj zakomentowany kod (max 7 dni z TODO)
- ZAWSZE usuwaj nieuÅ¼ywane zmienne i funkcje

### Import Organization

```typescript
// 1. External libraries
import { useState, useCallback } from "react";
import { useQuery, useMutation } from "@apollo/client";

// 2. UI components (shadcn/ui)
import { Button } from "@/components/ui/button";
import { Card } from "@/components/ui/card";

// 3. Internal components
import { ExerciseCard } from "@/components/exercises/ExerciseCard";

// 4. GraphQL
import { GET_EXERCISES_QUERY } from "@/graphql/queries";
import { CREATE_EXERCISE_MUTATION } from "@/graphql/mutations";

// 5. Utils & types
import { cn } from "@/lib/utils";
import type { Exercise } from "@/types";
```

### Direct Imports (NO barrel exports dla performance)

```typescript
// âœ… DOBRE: Direct imports
import { ExerciseCard } from "@/components/exercises/ExerciseCard";
import { Button } from "@/components/ui/button";

// âŒ ZÅE: Barrel exports (slower builds)
import { ExerciseCard, ExerciseForm } from "@/components/exercises";
```

## âš ï¸ COMMON PITFALLS

### 1. "use client" Directive

```typescript
// âœ… DOBRE: Na gÃ³rze pliku, przed importami
"use client";

import { useState } from "react";

// âŒ ZÅE: Po importach
import { useState } from "react";
("use client");
```

### 2. Server vs Client Component Confusion

```typescript
// âŒ ZÅE: useQuery w Server Component
// app/(dashboard)/exercises/page.tsx
export default function ExercisesPage() {
  const { data } = useQuery(GET_EXERCISES); // ğŸ’¥ Error!
}

// âœ… DOBRE: Client Component dla data fetching
// components/exercises/ExercisesList.tsx
("use client");

export function ExercisesList() {
  const { data } = useQuery(GET_EXERCISES); // âœ… OK
}

// app/(dashboard)/exercises/page.tsx
export default function ExercisesPage() {
  return <ExercisesList />; // Server component renders client component
}
```

### 3. Rules of Hooks

```typescript
// âŒ ZÅE: Hook po conditional return
if (loading) return <Loader />;
const callback = useCallback(() => {}, []); // ğŸ’¥ Error!

// âœ… DOBRE: Wszystkie hooki PRZED conditional returns
const callback = useCallback(() => {}, []);
if (loading) return <Loader />;
```

### 4. Form Number Inputs

```typescript
// âœ… DOBRE: Proper null handling dla number inputs
<Input
  type="number"
  value={field.value ?? ""}
  onChange={(e) => field.onChange(e.target.value ? Number(e.target.value) : null)}
/>

// âŒ ZÅE: BezpoÅ›rednie przypisanie (0 vs null problem)
<Input
  type="number"
  {...field}
/>
```

## ğŸ”„ NAMING CONVENTIONS

### Files & Folders

- **Components**: PascalCase (`ExerciseCard.tsx`)
- **Utils**: camelCase (`dateUtils.ts`)
- **Pages**: Folder-based (`exercises/page.tsx`)
- **GraphQL**: kebab-case z suffixem (`exercises.queries.ts`)

### Code

- **Components**: PascalCase (`ExerciseCard`)
- **Functions**: camelCase (`formatDate`)
- **Constants**: UPPER_SNAKE_CASE (`MAX_RETRY_COUNT`)
- **Types/Interfaces**: PascalCase (`ExerciseFormValues`)
- **GraphQL queries**: UPPER_SNAKE_CASE (`GET_EXERCISES_QUERY`)

## ğŸš€ FUTURE FEATURES

### Admin Dashboard (planned)

- System-wide settings management
- User management across organizations
- Analytics & reporting
- Audit logs

### Enhancements

- Command palette (Cmd+K)
- Keyboard shortcuts
- Drag & drop for exercise ordering
- Bulk operations
- Export/Import functionality
- Real-time collaboration

---

## ğŸ¯ SUPER DESIGN SYSTEM - Action-First UI/UX (Linear/Vercel Style)

### Filozofia

Inspiracja: **Linear**, **Vercel**, **Stripe Dashboard** - aplikacje ktÃ³re sÄ… samowyjaÅ›niajÄ…ce siÄ™ i sprzedajÄ… same siebie.

**Kluczowe zasady:**
1. **Action-First** - gÅ‚Ã³wna akcja zawsze widoczna i dominujÄ…ca
2. **Zero Cognitive Load** - uÅ¼ytkownik od razu wie co moÅ¼e zrobiÄ‡
3. **Visual Hierarchy** - hierarchia informacji przez wielkoÅ›Ä‡, kolor, pozycjÄ™
4. **Konsystencja** - te same wzorce na kaÅ¼dej stronie
5. **Elegancja** - subtelne animacje, pÅ‚ynne przejÅ›cia

### Struktura kaÅ¼dej strony (obowiÄ…zkowa)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. KOMPAKTOWY HEADER                                     â”‚
â”‚    [TytuÅ‚ strony]                    [Opcje/Filtry]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. HERO SECTION (opcjonalne - dla stron szczegÃ³Å‚Ã³w)      â”‚
â”‚    [DuÅ¼y obraz/ikona] [Nazwa] [Badge statusu]            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. HERO ACTION + QUICK STATS (grid 12 kolumn)            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”        â”‚
â”‚    â”‚ GÅÃ“WNA AKCJA    â”‚ â”‚Stat 1â”‚ â”‚Stat 2â”‚ â”‚Stat 3â”‚        â”‚
â”‚    â”‚ (6 col, gradient)â”‚ â”‚2 col â”‚ â”‚2 col â”‚ â”‚2 col â”‚        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. GÅÃ“WNA TREÅšÄ†                                          â”‚
â”‚    [Lista/Grid z danymi]                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5. SEKCJE DODATKOWE (Collapsible opcjonalnie)            â”‚
â”‚    [SzczegÃ³Å‚y, Notatki, Historia...]                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Hero Action Button Pattern

GÅ‚Ã³wny przycisk akcji - zawsze gradient primary, duÅ¼y, z animacjÄ… hover:

```typescript
// âœ… WZORZEC: Hero Action Button
<button
  onClick={handleMainAction}
  className="group relative overflow-hidden rounded-2xl bg-gradient-to-br from-primary via-primary to-primary-dark p-5 sm:p-6 text-left transition-all duration-300 hover:shadow-xl hover:shadow-primary/20 hover:scale-[1.02] cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed lg:col-span-6"
>
  {/* Animated background glow */}
  <div className="absolute inset-0 bg-gradient-to-br from-white/20 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300" />
  <div className="absolute -top-24 -right-24 w-48 h-48 bg-white/10 rounded-full blur-3xl group-hover:bg-white/20 transition-all duration-500" />
  
  <div className="relative flex items-center gap-4">
    <div className="flex h-12 w-12 items-center justify-center rounded-xl bg-white/20 backdrop-blur-sm shrink-0 group-hover:scale-110 transition-transform duration-300">
      <Icon className="h-6 w-6 text-white" />
    </div>
    <div className="min-w-0 flex-1">
      <h3 className="text-lg font-bold text-white mb-1">Nazwa Akcji</h3>
      <p className="text-sm text-white/80">KrÃ³tki opis</p>
    </div>
    <ArrowRight className="h-5 w-5 text-white/60 group-hover:text-white group-hover:translate-x-1 transition-all duration-300 shrink-0" />
  </div>
</button>
```

### Quick Stats Cards Pattern

Klikalne karty statystyk z filtrami:

```typescript
// âœ… WZORZEC: Clickable Quick Stat Card
<Card
  className={cn(
    "relative overflow-hidden transition-all duration-300 cursor-pointer lg:col-span-2",
    isActive
      ? "border-primary shadow-xl shadow-primary/10"
      : "border-border/60 hover:border-border hover:shadow-lg"
  )}
  onClick={() => setFilter("value")}
>
  <CardContent className="p-4">
    <div className="flex items-center gap-2 mb-2">
      <Icon className="h-4 w-4 text-primary" />
      <span className="text-xs text-muted-foreground">Etykieta</span>
    </div>
    <p className="text-2xl font-bold text-foreground">{count}</p>
  </CardContent>
</Card>
```

### Kompaktowy Header Pattern

TytuÅ‚ po lewej, akcje/filtry po prawej:

```typescript
// âœ… WZORZEC: Compact Header
<div className="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
  <h1 className="text-2xl font-bold text-foreground">TytuÅ‚ Strony</h1>
  
  <div className="flex items-center gap-3">
    {/* Search Input */}
    <div className="relative w-full sm:w-64">
      <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
      <Input
        placeholder="Szukaj..."
        className="pl-9 bg-surface border-border/60"
        value={search}
        onChange={(e) => setSearch(e.target.value)}
      />
    </div>
    
    {/* Options Dropdown */}
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="outline" size="sm">
          <Settings className="h-4 w-4 mr-2" />
          Opcje
        </Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent align="end">
        {/* ... */}
      </DropdownMenuContent>
    </DropdownMenu>
  </div>
</div>
```

### Card Hover Animations

Subtelne, eleganckie animacje na kartach:

```typescript
// âœ… WZORZEC: Elegant Card Hover
<div
  className={cn(
    "group relative rounded-xl border border-border/60 bg-surface overflow-hidden cursor-pointer",
    "transition-all duration-300 ease-out will-change-transform",
    "hover:-translate-y-1 hover:border-primary/40 hover:shadow-xl hover:shadow-primary/10"
  )}
>
  {/* Image with subtle zoom */}
  <div className="relative overflow-hidden">
    <img
      src={imageUrl}
      alt={title}
      loading="lazy"
      className="h-full w-full object-cover transition-transform duration-500 ease-out group-hover:scale-[1.03]"
    />
    <div className="absolute inset-0 bg-gradient-to-t from-black/50 via-black/10 to-transparent opacity-60 group-hover:opacity-40 transition-opacity duration-300" />
  </div>
</div>
```

### Staggered Animations

Animacje pojawiania siÄ™ elementÃ³w z opÃ³Åºnieniem:

```css
/* globals.css */
@keyframes fade-in {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

.animate-stagger > * {
  animation: fade-in 0.4s ease-out backwards;
}
.animate-stagger > *:nth-child(1) { animation-delay: 0ms; }
.animate-stagger > *:nth-child(2) { animation-delay: 50ms; }
.animate-stagger > *:nth-child(3) { animation-delay: 100ms; }
.animate-stagger > *:nth-child(4) { animation-delay: 150ms; }
/* ... do 10+ elementÃ³w */
```

```typescript
// UÅ¼ycie w komponencie
<div className="grid gap-4 sm:grid-cols-2 lg:grid-cols-3 animate-stagger">
  {items.map((item) => (
    <ItemCard key={item.id} item={item} />
  ))}
</div>
```

### Lists vs Expandable Cards

**ZAWSZE preferuj click-to-navigate zamiast expandable cards:**

```typescript
// âŒ ZÅE: Expandable card w liÅ›cie
<Card onClick={() => setExpanded(!expanded)}>
  {expanded && <ExpandedContent />}
</Card>

// âœ… DOBRE: Click-to-navigate
<Link href={`/items/${item.id}`} className="group ...">
  <div className="flex items-center gap-4">
    {/* Basic info */}
  </div>
  {/* Hover actions */}
  <div className="opacity-0 group-hover:opacity-100 transition-opacity">
    <Button variant="ghost" size="icon" onClick={(e) => { e.stopPropagation(); quickAction(); }}>
      <QuickActionIcon />
    </Button>
    <DropdownMenu>
      <DropdownMenuTrigger onClick={(e) => e.stopPropagation()}>
        <MoreHorizontal />
      </DropdownMenuTrigger>
      {/* ... */}
    </DropdownMenu>
  </div>
</Link>
```

### Hover Actions Pattern

Akcje widoczne tylko na hover:

```typescript
// âœ… WZORZEC: Hover Actions
<div className="flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
  <Button
    variant="ghost"
    size="icon"
    className="h-8 w-8"
    onClick={(e) => { e.preventDefault(); e.stopPropagation(); handleQuickAction(); }}
    title="Tooltip"
  >
    <ActionIcon className="h-4 w-4" />
  </Button>
  <DropdownMenu>
    <DropdownMenuTrigger asChild onClick={(e) => e.stopPropagation()}>
      <Button variant="ghost" size="icon" className="h-8 w-8">
        <MoreHorizontal className="h-4 w-4" />
      </Button>
    </DropdownMenuTrigger>
    <DropdownMenuContent align="end">
      {/* Menu items */}
    </DropdownMenuContent>
  </DropdownMenu>
</div>
```

### Grid Layout (12 kolumn)

Responsywny grid z 12 kolumnami:

```typescript
// âœ… WZORZEC: 12-column grid
<div className="grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-12">
  {/* Hero Action - 6 kolumn */}
  <div className="lg:col-span-6">...</div>
  
  {/* Stats - po 2 kolumny kaÅ¼da */}
  <div className="lg:col-span-2">...</div>
  <div className="lg:col-span-2">...</div>
  <div className="lg:col-span-2">...</div>
</div>
```

### Collapsible Sections

Dla dodatkowych informacji:

```typescript
// âœ… WZORZĞ•Ğ¦: Collapsible Section
<Collapsible defaultOpen={false}>
  <CollapsibleTrigger className="flex w-full items-center justify-between p-4 hover:bg-surface-light transition-colors rounded-lg">
    <div className="flex items-center gap-3">
      <Icon className="h-5 w-5 text-muted-foreground" />
      <span className="font-medium">TytuÅ‚ Sekcji</span>
    </div>
    <ChevronDown className="h-4 w-4 text-muted-foreground transition-transform duration-200 group-data-[state=open]:rotate-180" />
  </CollapsibleTrigger>
  <CollapsibleContent>
    {/* Content */}
  </CollapsibleContent>
</Collapsible>
```

### Sortowanie list

Nieaktywne/mniej waÅ¼ne elementy zawsze na dole:

```typescript
// âœ… WZORZEC: Sorting inactive to bottom
const sortedItems = [...items].sort((a, b) => {
  // Inactive at bottom
  if (a.isActive !== b.isActive) return a.isActive ? -1 : 1;
  // Then by relevance (e.g., count, date)
  return b.count - a.count;
});
```

### Image Loading

Zawsze lazy loading dla obrazÃ³w:

```typescript
// âœ… WZORZĞ•Ğ¦: Lazy Loading Images
<img
  src={imageUrl}
  alt={title}
  loading="lazy"
  className="..."
/>
```

### Kolory gradientÃ³w wg kontekstu

- **Primary action**: `bg-gradient-to-br from-primary via-primary to-primary-dark`
- **Secondary/Info**: `bg-gradient-to-br from-info to-cyan-600`
- **Warning**: `bg-gradient-to-br from-warning to-orange-600`
- **Premium/Special**: `bg-gradient-to-br from-violet-500 to-purple-600`
- **Subtle card accent**: `h-1 bg-gradient-to-r from-primary to-emerald-600` (top border)

### Badge warianty

```typescript
<Badge variant="success">Aktywny</Badge>
<Badge variant="secondary">Darmowy</Badge>
<Badge variant="destructive">Nieaktywny</Badge>
<Badge className="bg-primary/20 text-primary border-0">Custom</Badge>
```

---

**Cel**: Nowoczesny, intuicyjny admin portal dla fizjoterapeutÃ³w
**Styl**: Senior developer - przemyÅ›lany, minimalistyczny, efektywny
**PodejÅ›cie**: Najpierw myÅ›l, potem koduj. Zawsze z uwzglÄ™dnieniem UX.
**Next.js 2025**: App Router, Server/Client Components, "use client" directive
**GraphQL**: Apollo Client 4.0, useQuery z skip, fragmenty, token exchange
**Design**: Action-First, Linear/Vercel style, konsystentne wzorce

## ğŸ—ƒï¸ BACKEND DATA SCHEMA (C# .NET Core)

### Exercise (Ä†wiczenie)

Id, Name, Description, Type ("reps"|"time"), Sets, Reps, Duration
RestSets, RestReps, PreparationTime, ExecutionTime
ExerciseSide ("left"|"right"|"alternating"|"both"|"none")
ImageUrl, Images[], GifUrl, VideoUrl, Notes, MainTags[], AdditionalTags[]
Scope (Personal|Organization|Global), IsActive, IsPublicTemplate

### ExerciseSet (Zestaw Ä‡wiczeÅ„)

Id, Name, Description, OrganizationId, IsActive, IsTemplate
Frequency { TimesPerDay, TimesPerWeek, BreakBetweenSets, Monday-Sunday }
Relations: ExerciseMappings[], PatientAssignments[]

### ExerciseSetMapping (Ä†wiczenie w zestawie)

Id, ExerciseSetId, ExerciseId, Order
Sets, Reps, Duration, RestSets, RestReps (nadpisujÄ… Exercise)
CustomName, CustomDescription, Notes (personalizacja dla zestawu)

### PatientAssignment

Id, ExerciseSetId, UserId, AssignedById, Status, StartDate, EndDate
Frequency (moÅ¼e nadpisywaÄ‡ zestaw)
